# 培养方案导入功能使用说明

## 功能概述

本功能允许教师在"我的学生"页面中批量导入培养方案课程信息，支持Excel和CSV格式文件。

## 功能位置

- 页面：教师管理平台 → 我的学生
- 按钮位置：批量删除学生按钮左侧（绿色按钮，带有Excel图标）

## 使用步骤

### 第一步：下载模板
1. 点击"导入培养方案"按钮
2. 在弹出的模态框中点击"下载模板"按钮
3. 系统会自动下载一个Excel (.xlsx) 格式的模板文件

### 第二步：填写数据
模板包含以下字段：
- **课程号**：课程的唯一编号（必填）
- **课程名称**：课程的全称（必填）
- **学分**：课程的学分数（必填，数字）
- **建议修读年级**：如"大一"、"大二"等
- **学期**：如"第一学期"、"第二学期"等
- **考试方式**：如"笔试"、"上机考试"、"论文"等
- **课程性质**：如"必修课"、"选修课"等

**注意事项：**
- 请严格按照模板格式填写
- 必填字段不能为空
- 学分必须是数字
- 保存时保持Excel (.xlsx) 格式
- 如需使用CSV，请使用UTF-8编码

### 第三步：上传文件
1. 在导入模态框中点击上传区域
2. 选择填写好的Excel文件 (.xlsx推荐) 或CSV文件
3. 系统会自动解析文件并显示预览

### 第四步：确认导入
1. 检查预览数据是否正确
2. 点击"确认导入"按钮
3. 等待导入完成并查看结果

## 支持的文件格式

- Excel文件：.xlsx, .xls
- CSV文件：.csv（推荐使用UTF-8编码）

## 错误处理

### 常见错误及解决方案

1. **文件格式不正确**
   - 解决：确保下载官方模板，不要修改表头

2. **必填字段为空**
   - 解决：检查课程号、课程名称、学分是否填写

3. **学分不是数字**
   - 解决：确保学分字段填写的是数字

4. **文件编码问题**
   - 解决：使用UTF-8编码保存CSV文件

5. **文件过大**
   - 解决：建议单次导入不超过1000条记录

## 功能特性

- **模板下载**：提供标准模板，确保数据格式正确
- **文件解析**：自动解析Excel和CSV文件
- **数据预览**：导入前可预览数据内容
- **错误提示**：详细的错误信息，便于快速定位问题
- **批量处理**：支持一次性导入多条课程记录

## 技术实现

### 前端技术栈
- React + TypeScript
- 文件读取：FileReader API
- 文件解析：自定义CSV解析器
- UI组件：自定义模态框和表格组件

### 后端接口
- 模板下载：GET /api/training-program/template
- 数据导入：POST /api/training-program/import

### 数据存储
- 课程信息存储在training_program_courses表中
- 支持批量插入和事务处理

## 后续优化计划

1. 支持更多文件格式（如JSON）
2. 添加数据验证规则配置
3. 支持增量导入和更新
4. 添加导入历史记录
5. 支持模板自定义字段

## 联系支持

如遇到问题，请联系技术支持团队。